<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Binary Referral Tree - EduFort</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
/* Binary Tree Styles */
body { font-family: 'Poppins', sans-serif; background:#f4f7fc; margin:0; color:#333; }
h1 { text-align:center; color:#1e3a8a; margin:40px 0 20px 0; }
#tree-container { display:flex; flex-direction:column; align-items:center; position:relative; padding-bottom:50px; }
.tree-level { display:flex; justify-content:center; gap:60px; position:relative; margin-bottom:80px; }
.tree-node { display:flex; flex-direction:column; align-items:center; position:relative; transition: transform 0.3s; }
.tree-node img { border-radius:50%; width:80px; height:80px; object-fit:cover; background:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s, border 0.3s; }
.tree-node img:hover { transform:scale(1.1); box-shadow:0 8px 20px rgba(0,0,0,0.2); }
.tree-node p { margin-top:8px; font-weight:600; color:#1e3a8a; text-align:center; }
.commission-box { margin-top:6px; padding:4px 8px; background:#fde68a; color:#92400e; border-radius:4px; font-size:13px; font-weight:600; text-align:center; }
.tooltip { position:absolute; background:#1e3a8a; color:#fff; padding:6px 12px; border-radius:6px; font-size:13px; white-space:nowrap; opacity:0; pointer-events:none; transition:opacity 0.3s; top:-140px; z-index:10; width:220px; text-align:left; }
.tree-node:hover .tooltip { opacity:1; }
.line { position:absolute; background:#1e3a8a; z-index:-1; height:2px; }
#user-form { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin:20px auto 50px auto; }
#user-form input, #user-form button, #user-form select { padding:8px 12px; font-size:14px; border-radius:6px; border:1px solid #ccc; }
#user-form button { background:#ff6600; color:#fff; border:none; font-weight:600; cursor:pointer; transition:background 0.3s; }
#user-form button:hover { background:#e65c00; }
.node-actions { margin-top:5px; display:flex; gap:5px; flex-wrap:wrap; }
.node-actions button { padding:4px 6px; font-size:12px; border-radius:4px; border:none; cursor:pointer; font-weight:600; }
.node-actions .invite { background:#10b981; color:#fff; }
.node-actions .delete { background:#ef4444; color:#fff; }
.level-0, .level-1, .level-2, .level-3 { border-radius:50%; padding:10px; }

@media (max-width:768px){ .tree-node img{width:60px;height:60px;} .tree-level{gap:40px;margin-bottom:60px;} .commission-box{font-size:12px;} }
@media (max-width:480px){ .tree-node img{width:50px;height:50px;} .tree-level{gap:20px;margin-bottom:50px;} .commission-box{font-size:11px;} }
</style>
</head>
<body>

<!-- TOP MARQUEE -->
<div class="top-marquee">
    <marquee behavior="scroll" direction="left" scrollamount="8">
      ðŸš€ EduFort Technologies | Smart Safety for Smarter Schools | Trusted Happy Clients | Years of Experience | No. of Users | Our Office | STUDENT SECURITY SYSTEMS | ERP SOFTWARE (SCHOOL & COLLEGES) | Many more
    </marquee>
</div>

<!-- HEADER -->
<header class="site-header">
   <div class="wrap navbar">
   <a href="index.html" class="brand">
    <img src="images/logo_circle.png" alt="EduFort Technologies" class="brand-img">
    <div class="brand-text">
        <div class="brand-name">EduFORT Technologies</div>
        <div class="brand-tagline">Smart Safety for Smarter Schools</div>
    </div>
   </a>

      <button id="nav-toggle" aria-label="toggle menu">â˜°</button>
      <nav id="nav" class="main-menu">
        <ul>
          <li><a href="index.html#home">Home</a></li>
          <li><a href="index.html#about">About</a></li>
          <li><a href="index.html#services">Services</a></li>
	  <li><a href="index.html#technology">Technology</a></li>
          <li><a href="index.html#pricing">Pricing</a></li>
	  <li><a href="index.html#commission">Commission</a></li>
          <li><a href="index.html#promise">Promise</a></li>
          <li><a href="index.html#team">Team</a></li>
          <li><a href="index.html#contact">Contact</a></li>
	  <li class="mobile-demo"><a href="index.html#contact" class="demo-btn">Book Demo</a></li>
	</ul>
      </nav>

      <div class="book-demo desktop-demo">
      <a href="index.html#contact" class="demo-btn">Book Demo</a>
    </div>
   </div>
</header>

<!-- Binary Tree Section -->
<h1>Professional Binary Referral Tree</h1>

<form id="user-form">
  <input type="file" id="photo" accept="image/*" required>
  <input type="text" id="name" placeholder="Name" required>
  <input type="date" id="join" required>
  <input type="number" id="students" placeholder="Student Count" required>
  <input type="number" id="planPrice" placeholder="Plan Price" required>
  <input type="text" id="commissionPreview" placeholder="Commission 5%" readonly style="background:#f0f0f0;">
  <select id="status">
    <option value="Active">Active</option>
    <option value="Inactive">Inactive</option>
  </select>
  <button type="submit" class="demo-btn">Add Referral</button>
</form>

<div id="tree-container">
  <div class="tree-level" data-level="0">
    <div class="tree-node level-0" data-id="1" data-name="EduFort Technologies" data-join="2025-08-15" data-students="0" data-plan="0" data-commission="0" data-status="Active">
      <img src="images/company-logo.png" alt="EduFort Technologies" style="border:3px solid #10b981;">
      <p>EduFort Technologies</p>
      <div class="tooltip">
        Name: EduFort Technologies<br>DOJ: 2025-08-15<br>Status: Active
      </div>
      <div class="node-actions">
        <button class="invite">Invite</button>
      </div>
    </div>
  </div>
</div>

<script>
// Binary Tree JS with real-time commission
let userIdCounter = 2;
let treeData = [
  {id:1,parentId:null,name:'EduFort Technologies',join:'2025-08-15',students:0,plan:0,commission:0,status:'Active',photo:'images/company-logo.png'}
];

const treeContainer=document.getElementById('tree-container');
const levelsColors=['level-0','level-1','level-2','level-3'];

function buildTree(){
  treeContainer.innerHTML='';
  const levels=[];
  let currentLevel=[treeData.find(u=>u.id===1)];
  let levelIndex=0;
  while(currentLevel.length>0){
    levels[levelIndex]=currentLevel;
    const nextLevel=[];
    currentLevel.forEach(node=>{
      treeData.filter(u=>u.parentId===node.id).forEach(child=>nextLevel.push(child));
    });
    currentLevel=nextLevel;
    levelIndex++;
  }
  levels.forEach((level,idx)=>{
    const levelDiv=document.createElement('div');
    levelDiv.classList.add('tree-level');
    levelDiv.dataset.level=idx;
    level.forEach(node=>{
      const nodeDiv=document.createElement('div');
      nodeDiv.classList.add('tree-node');
      nodeDiv.classList.add(levelsColors[idx] || 'level-3');
      nodeDiv.dataset.id=node.id;
      nodeDiv.dataset.name=node.name;
      nodeDiv.dataset.join=node.join;
      nodeDiv.dataset.students=node.students;
      nodeDiv.dataset.plan=node.plan;
      nodeDiv.dataset.commission=node.commission;
      nodeDiv.dataset.status=node.status;

      const borderColor = node.status==='Active' ? '#10b981' : '#ef4444';

      nodeDiv.innerHTML=`
        <img src="${node.photo || 'images/placeholder-user.png'}" alt="${node.name}" style="border:3px solid ${borderColor};">
        <p>${node.name}</p>
        ${node.id !== 1 ? `<div class="commission-box">Commission: Rs. ${node.commission}</div>` : ''}
        <div class="tooltip">
          Name: ${node.name}<br>DOJ: ${node.join}<br>${node.id !==1 ? `Students: ${node.students}<br>Plan: Rs. ${node.plan}<br>Commission 5%: Rs. ${node.commission}<br>` : ''}Status: ${node.status}
        </div>
        <div class="node-actions">
          <button class="invite">Invite</button>
          ${node.id !==1 ? '<button class="delete">Delete</button>' : ''}
        </div>
      `;

      if(node.id!==1){
        nodeDiv.querySelector('.delete').addEventListener('click',()=>{ deleteNode(node.id); });
      }
      nodeDiv.querySelector('.invite').addEventListener('click',()=>{ alert(`Invite link for ${node.name}`); });

      levelDiv.appendChild(nodeDiv);
    });
    treeContainer.appendChild(levelDiv);
  });
  setTimeout(drawLines,100);
}

function drawLines(){
  document.querySelectorAll('.line').forEach(l=>l.remove());
  treeData.forEach(node=>{
    if(node.parentId){
      const parentNode=document.querySelector(`.tree-node[data-id="${node.parentId}"]`);
      const childNode=document.querySelector(`.tree-node[data-id="${node.id}"]`);
      if(parentNode && childNode){
        const line=document.createElement('div');
        line.classList.add('line');
        const parentRect=parentNode.getBoundingClientRect();
        const childRect=childNode.getBoundingClientRect();
        const containerRect=treeContainer.getBoundingClientRect();
        const x1=parentRect.left+parentRect.width/2-containerRect.left;
        const y1=parentRect.bottom-containerRect.top;
        const x2=childRect.left+childRect.width/2-containerRect.left;
        const y2=childRect.top-containerRect.top;
        const length=Math.hypot(x2-x1,y2-y1);
        const angle=Math.atan2(y2-y1,x2-x1)*180/Math.PI;
        line.style.width=length+'px';
        line.style.transformOrigin='0 0';
        line.style.transform=`rotate(${angle}deg)`;
        line.style.position='absolute';
        line.style.left=x1+'px';
        line.style.top=y1+'px';
        treeContainer.appendChild(line);
      }
    }
  });
}

function deleteNode(nodeId){
  const toDelete=[nodeId];
  while(true){
    const children=treeData.filter(u=>toDelete.includes(u.parentId)).map(u=>u.id);
    if(children.length===0) break;
    toDelete.push(...children);
  }
  treeData=treeData.filter(u=>!toDelete.includes(u.id));
  buildTree();
}

// Real-time commission calculation
const studentsInput = document.getElementById('students');
const planInput = document.getElementById('planPrice');
const commissionPreview = document.getElementById('commissionPreview');

function updateCommission(){
  const students = parseInt(studentsInput.value) || 0;
  const plan = parseInt(planInput.value) || 0;
  const commission = Math.round(students * plan * 0.05);
  commissionPreview.value = 'Rs. ' + commission;
}

studentsInput.addEventListener('input', updateCommission);
planInput.addEventListener('input', updateCommission);

// Add user via form
document.getElementById('user-form').addEventListener('submit',e=>{
  e.preventDefault();
  const name=document.getElementById('name').value;
  const join=document.getElementById('join').value;
  const students=parseInt(document.getElementById('students').value);
  const plan=parseInt(document.getElementById('planPrice').value);
  const status=document.getElementById('status').value;
  const photoFile=document.getElementById('photo').files[0];

  if(!photoFile){ alert('Please select a photo.'); return; }

  const reader=new FileReader();
  reader.onload=function(event){
    const photoURL=event.target.result;
    const commission=Math.round(students*plan*0.05);
    let parentNode=treeData.find(u=>treeData.filter(c=>c.parentId===u.id).length<2);
    if(!parentNode) parentNode=treeData[0];
    treeData.push({id:userIdCounter++, parentId:parentNode.id, name:name, join:join, students:students, plan:plan, commission:commission, status:status, photo:photoURL});
    buildTree();
  }
  reader.readAsDataURL(photoFile);
  document.getElementById('user-form').reset();
  commissionPreview.value = '';
});

window.addEventListener('load',buildTree);
window.addEventListener('resize',drawLines);
</script>

</body>
</html>
